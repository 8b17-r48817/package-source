pkgname=athena-everblush-theme
pkgver=r21.abb404a
pkgrel=1
pkgdesc="Everblush GTK theme for Athena."
arch=('any')
license=("GPL3")
depends=()
makedepends=('git' 'npm')
source=("git+https://github.com/Everblush/gtk"
        "git+https://github.com/alvatip/Nordzy-icon"
        "git+https://github.com/alvatip/Radioactive-nord"
        "git+https://github.com/Everblush/wallpapers"
        "https://raw.githubusercontent.com/kovidgoyal/kitty-themes/master/themes/Atom.conf"
        "mechanic-keyboard.png"
        "$pkgname.tar.gz")
sha512sums=('SKIP'
            'SKIP'
            'SKIP'
            'SKIP'
            '22c3d829948177fbc8a36715a97b0bf9a1742a6db799fd7cb76414518bdc9434e8412073d44c6c7c1e3e1709c18e88fb62c973e57105a67315ed89fbac733bec'
            'f39efd5289beacf4e5bd0165c057aaa4904a034a7c3bbc8a563f244e5bcf534f2e902b1b1d24c461e6f569223df6905ac2ab95555e3fded4bc3d93bdff945599'
            '66b51021c8fccf2c09de4814fd94ec58a8e7e73927dd4aa60a46270b7ef754517bab81516977ceb34b3fd624ce6388f08c95cdaad08ed27db4af3e97019c3752')

pkgver() {
    cd gtk

    printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)" 
}

package() {
    cd gtk

    _npmdir="$pkgdir/usr/lib/node_modules/"

    install -dm 755 "$_npmdir"

    cd "$_npmdir"

    npm install --user root -g --prefix "$pkgdir/usr" scss

    cd "$srcdir/gtk"

    # Install Everblush theme in /usr/share/themesZ
    make DESTDIR="$pkgdir" install

    cp -a "$srcdir/Everblush-xfwm" "$pkgdir/usr/share/themes/"

    # Install icon theme
    cd "${srcdir}/Nordzy-icon"
    install -dm755 "${pkgdir}/usr/share/icons"
    ./install.sh -d "${pkgdir}/usr/share/icons" -t cyan -c dark

    # Install cursor theme
    cd "${srcdir}/Radioactive-nord"
    cp -a Radioactive-nord "${pkgdir}/usr/share/icons/"

    # Install wallpapers
    cd "${srcdir}/wallpapers"
    install -dm 755 "${pkgdir}/usr/share/wallpapers/Everblush"
    cp -a *.png "${pkgdir}/usr/share/wallpapers/Everblush/"

    cd "${srcdir}"
    install -dm 755 "$pkgdir/etc/skel/.config/kitty"
    install -dm 755 "$pkgdir/usr/share/icons/hicolor/scalable"
    install -dm 755 "$pkgdir/usr/share/backgrounds/default"

    install -Dm 644 "mechanic-keyboard.png" "$pkgdir/usr/share/backgrounds/default/"
    install -Dm 644 "Atom.conf" "$pkgdir/etc/skel/.config/kitty/current-theme.conf"

    cp -a "$srcdir/icons/apps" "$pkgdir/usr/share/icons/hicolor/scalable/"
    cp -a "$srcdir/icons/categories" "$pkgdir/usr/share/icons/hicolor/scalable/"
}
