pkgname=athena-hyprland-config
_pkgname=dots-hyprland
pkgver=446.6e22e302
pkgrel=1
pkgdesc="Hyprland configuration for Athena."
arch=('any')
url='https://github.com/end-4/dots-hyprland'
license=("GPL3")
depends=('aylurs-gtk-shell' 'bc' 'blueberry' 'bluez' 'boost' 'boost-libs' 'brightnessctl' 'cava' 'cliphist' 'coreutils' 'curl' 'findutils' 'foot' 'fuzzel' 'fzf' 'gawk' 'geticons-git' 'gnome-control-center' 'gnome-keyring' 'gnome-system-monitor' 'gojq' 'grim' 'gtklock' 'gtklock-playerctl-module' 'gtklock-powerbar-module' 'gtklock-userinfo-module' 'hyprland-nvidia-git' 'ibus' 'imagemagick' 'libqalculate' 'light' 'nautilus' 'nerd-fonts-noto-sans-mono-extended' 'network-manager-applet' 'networkmanager' 'nlohmann-json' 'noto-fonts-emoji' 'nwg-look' 'pavucontrol' 'pipewire' 'pipewire-pulse' 'plasma-browser-integration' 'playerctl' 'polkit-gnome' 'procps' 'python-desktop-entry-lib' 'python-material-color-utilities' 'python-pillow' 'python-poetry' 'python-pywal' 'ripgrep' 'slurp' 'socat' 'sox' 'swappy' 'swaybg' 'swayidle' 'swww' 'udev' 'upower' 'util-linux' 'wget' 'wireplumber' 'wl-clipboard' 'wlogout' 'wofi' 'xdg-desktop-portal-hyprland-git' 'xdg-user-dirs' 'xorg-xrandr' 'yad' 'ydotool')
makedepends=('git' 'rsync')
install='hyprland.install'
source=("git+https://github.com/end-4/$_pkgname#branch=illogical-impulse"
        "hyprland-init.desktop"
        "hyprland-init"
        "hyprland-shell"
        "dconf-desktop.ini")
sha512sums=('SKIP'
            '297f8a0ee6668703d2dc37eef759f19cd7b3636b48b3cf7db4c932baba753c5c519aae429aab1408d96bf724f211bb945dbbcb0a6e4cba280af1422b87703a8c'
            'b65c9160af36f9fa12e67fc9543c3a37a667cfd7dc39c0f76b8453049631a477500f1077ee80c787b3640c94b9de76d3a482ebd42d2fab81d49cf0e83334ffb3'
            'da4b315b631f612a46fc1e7e510b193efbc25a60f0699099a4bc1bf475d87747fe3e1557a1b70bd7a84a5f9406ada3191c9a635fc6adffd35cf4791f6fcb406a'
            'a7a8b2f5e34d83d7f413b33941869dd29d4b3277821f63fe6972d8dbed6937743229bde2bbc49bd1ef91eda733ec720c9a501e395815197dc83d7e7718c90b31')

pkgver() {
  cd $_pkgname

  echo $(git rev-list --count HEAD).$(git rev-parse --short HEAD)
}

package() {
  install -dm 755 "$pkgdir/etc/skel/.config"
  install -dm 755 "$pkgdir/etc/skel/.local/share"
  install -dm 755 "${pkgdir}/etc/xdg/autostart"
  install -dm 755 "$pkgdir/usr/bin"
  install -dm 755 "$pkgdir/usr/share/gnome-text-editor/styles"
  install -dm 755 "$pkgdir/usr/share/$pkgname"
  
  cd $_pkgname

  rsync -av --progress ./.config/ags "$pkgdir/etc/skel/.config/"
  rsync -av --progress ./.config/foot "$pkgdir/etc/skel/.config/"
  rsync -av --progress ./.config/fuzzel "$pkgdir/etc/skel/.config/"
  rsync -av --progress ./.config/gtk-3.0 "$pkgdir/etc/skel/.config/"
  rsync -av --progress ./.config/gtk-4.0 "$pkgdir/etc/skel/.config/"
  rsync -av --progress ./.config/gtklock "$pkgdir/etc/skel/.config/"
  rsync -av --progress ./.config/hypr "$pkgdir/etc/skel/.config/"
  rsync -av --progress ./.config/mpv "$pkgdir/etc/skel/.config/"
  rsync -av --progress ./.config/wlogout "$pkgdir/etc/skel/.config/"
  rsync -av --progress ./.config/code-flags.conf "$pkgdir/etc/skel/.config/"
  rsync -av --progress ./.config/starship.toml "$pkgdir/etc/skel/.config/"
  rsync -av --progress ./.local/bin "$pkgdir/etc/skel/.local/"
  rsync -av --progress ./.local/share/fonts "$pkgdir/etc/skel/.local/share/"
  rsync -av --progress "./Import Manually/execs (add to path)/" "$pkgdir/etc/skel/.local/bin/"
  #rsync -av --progress "./Import Manually/gnome-text-editor themes (Paste to root)/usr/share/gnome-text-editor/styles/" "$pkgdir/usr/share/gnome-text-editor/styles/"

  install -Dm 644 $srcdir/hyprland-init.desktop "$pkgdir/etc/xdg/autostart/"
  install -Dm 755 $srcdir/hyprland-init "$pkgdir/usr/bin/"
  #install -Dm 644 $srcdir/hyprland.conf "$pkgdir/etc/skel/.config/hypr/"
  #install -Dm 644 $srcdir/keybinds.conf "$pkgdir/etc/skel/.config/hypr/"
  install -Dm 755 $srcdir/hyprland-shell "$pkgdir/usr/bin/"
  install -Dm 644 $srcdir/dconf-desktop.ini "$pkgdir/usr/share/$pkgname/"

  sed -i "/^clipboard-copy/d" "$pkgdir/etc/skel/.config/foot/foot.ini" #Removing ctrl+c mapping
  sed -i "/^clipboard-paste/d" "$pkgdir/etc/skel/.config/foot/foot.ini" #Removing ctrl+v mapping
  sed -i "/shell=fish/d" "$pkgdir/etc/skel/.config/foot/foot.ini" #Removing shell=fish enforce
  touch "${pkgdir}/etc/skel/.flag-hyprland-once"
}
